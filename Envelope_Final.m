function Envelope = Envelope_Final (kappa, omega, epsilon_cr,beta_z1,beta_z2,beta_z3,beta_z4, k111, M111, ...
                                              k211, M211, k212, M212, k221, M221, k222, M222, ...
                                              k311, M311, k312, M312, k321, M321, k322, M322, ...
                                              k411, M411, k412, M412, k421, M421, k422, M422, ...
                                              k4222,M4222,beta_1,beta_2,beta_3,alpha)
%beta_all = [beta_z1;beta_z2;beta_z3;beta_z4];

        T=1;R=1;C=1;RC=1;

        [Envelope1,T,C,R,RC] = calculateEnvelope_new_2(kappa, omega, epsilon_cr,beta_z1, k111, M111, ...
                                              k211, M211, k212, M212, k221, M221, k222, M222, ...
                                              k311, M311, k312, M312, k321, M321, k322, M322, ...
                                              k411, M411, k412, M412, k421, M421, k422, M422, ...
                                              k4222,M4222,beta_1,beta_2,beta_3,alpha,T,C,R,RC);
        
        [Envelope2,T,C,R,RC] = calculateEnvelope_new_2(kappa, omega, epsilon_cr,beta_z2, k111, M111, ...
                                              k211, M211, k212, M212, k221, M221, k222, M222, ...
                                              k311, M311, k312, M312, k321, M321, k322, M322, ...
                                              k411, M411, k412, M412, k421, M421, k422, M422, ...
                                              k4222,M4222,beta_1,beta_2,beta_3,alpha,T,C,R,RC);
        [Envelope3,T,C,R,RC] = calculateEnvelope_new_2(kappa, omega, epsilon_cr,beta_z3, k111, M111, ...
                                              k211, M211, k212, M212, k221, M221, k222, M222, ...
                                              k311, M311, k312, M312, k321, M321, k322, M322, ...
                                              k411, M411, k412, M412, k421, M421, k422, M422, ...
                                              k4222,M4222,beta_1,beta_2,beta_3,alpha,T,C,R,RC);
        [Envelope4,T,C,R,RC] = calculateEnvelope_new_2(kappa, omega, epsilon_cr,beta_z4, k111, M111, ...
                                              k211, M211, k212, M212, k221, M221, k222, M222, ...
                                              k311, M311, k312, M312, k321, M321, k322, M322, ...
                                              k411, M411, k412, M412, k421, M421, k422, M422, ...
                                              k4222,M4222,beta_1,beta_2,beta_3,alpha,T,C,R,RC);
        %clear calculateEnvelope_new_2;
        
        Envelope=[Envelope1;Envelope2;Envelope3;Envelope4];

end